{
	"name": "Blog to Postiz Auto-Schedule",
	"nodes": [
		{
			"parameters": {
				"httpMethod": "POST",
				"path": "content-repurpose",
				"responseMode": "responseNode",
				"options": {}
			},
			"id": "webhook-trigger",
			"name": "Webhook",
			"type": "n8n-nodes-base.webhook",
			"typeVersion": 2,
			"position": [250, 300],
			"webhookId": "content-repurpose-webhook"
		},
		{
			"parameters": {
				"method": "POST",
				"url": "http://host.containers.internal:11434/api/generate",
				"sendBody": true,
				"specifyBody": "json",
				"jsonBody": "={{ JSON.stringify({ model: 'gemma2:9b', prompt: `You are Alex Mayhew, a Technical Advisor who helps CTOs avoid $500K architecture mistakes.\n\nYour voice:\n- Direct and authoritative—take clear positions, no hedging\n- Technical but always tied to business outcomes\n- Use specific numbers (40%, 10x, 100k+)—never vague\n- Dense—every sentence carries weight, no filler\n\nNEVER use emojis. Ever.\n\n<task>Convert this blog post into a LinkedIn text post (NOT a carousel)</task>\n\n<rules>\n- 150-250 words total\n- First line MUST stop the scroll (bold claim or counterintuitive statement)\n- Use line breaks every 1-2 sentences\n- Include 3-4 concrete insights with specific numbers\n- End with a question to drive engagement\n- NO hashtags (LinkedIn algorithm no longer boosts them in 2026)\n- NO emojis, NO hedging\n- NO external links in the post body\n- Use arrows or bullet points for lists\n- End with a specific question to drive comments\n</rules>\n\n<input>\nTitle: ${$json.body.title}\n\n${$json.body.content}\n</input>\n\nOutput ONLY the LinkedIn post text, ready to publish.`, stream: false, options: { temperature: 0.7, num_predict: 600 } }) }}",
				"options": {
					"timeout": 180000
				}
			},
			"id": "ollama-linkedin",
			"name": "Generate LinkedIn",
			"type": "n8n-nodes-base.httpRequest",
			"typeVersion": 4.2,
			"position": [500, 100]
		},
		{
			"parameters": {
				"method": "POST",
				"url": "http://host.containers.internal:11434/api/generate",
				"sendBody": true,
				"specifyBody": "json",
				"jsonBody": "={{ JSON.stringify({ model: 'gemma2:9b', prompt: `You are Alex Mayhew, a Technical Advisor who helps CTOs avoid $500K architecture mistakes.\n\nYour voice:\n- Direct and authoritative—take clear positions\n- Specific numbers (40%, 10x, 100k+)—never vague\n- Experience-backed (\"I've advised 30+ startups...\")\n- Punchy and dense\n\nNEVER use emojis.\n\n<task>Convert this blog post into a single standalone tweet</task>\n\n<rules>\n- Maximum 280 characters to prevent truncation\n- Lead with the most contrarian or surprising insight\n- Include one specific number or metric\n- NEVER include external links (links receive a 270% reach penalty on X in 2026)\n- NEVER use hashtags (hashtags trigger spam filters and provide no algorithm boost in 2026)\n- NO emojis\n- The tweet must stand completely alone as valuable insight\n</rules>\n\n<input>\nTitle: ${$json.body.title}\n\n${$json.body.content}\n</input>\n\nOutput ONLY the tweet text. No quotes, no explanation, just the tweet.`, stream: false, options: { temperature: 0.6, num_predict: 200 } }) }}",
				"options": {
					"timeout": 180000
				}
			},
			"id": "ollama-twitter",
			"name": "Generate Twitter",
			"type": "n8n-nodes-base.httpRequest",
			"typeVersion": 4.2,
			"position": [500, 300]
		},
		{
			"parameters": {
				"method": "POST",
				"url": "http://host.containers.internal:11434/api/generate",
				"sendBody": true,
				"specifyBody": "json",
				"jsonBody": "={{ JSON.stringify({ model: 'gemma2:9b', prompt: `You are Alex Mayhew, a Technical Advisor who helps CTOs avoid $500K architecture mistakes.\n\nYour voice:\n- Direct and authoritative\n- Technical depth for developers\n- Use specific numbers (40%, 10x, 100k+)\n- Experience-backed\n- Conversational for Dev.to community\n\nNEVER use emojis in the body.\n\n<task>Create a Dev.to article summary</task>\n\n<rules>\n- Start with TL;DR (2-3 bullet points)\n- Then 3-4 key sections with headers\n- Include code blocks if relevant\n- End with Key Takeaways (3-5 bullets)\n- Add canonical link note at end\n- 500-800 words total\n</rules>\n\n<input>\nTitle: ${$json.body.title}\nSlug: ${$json.body.slug || 'post'}\n\n${$json.body.content}\n</input>\n\nOutput the Dev.to article body (no frontmatter, just content).`, stream: false, options: { temperature: 0.7, num_predict: 1500 } }) }}",
				"options": {
					"timeout": 180000
				}
			},
			"id": "ollama-devto",
			"name": "Generate DevTo",
			"type": "n8n-nodes-base.httpRequest",
			"typeVersion": 4.2,
			"position": [500, 500]
		},
		{
			"parameters": {
				"mode": "append"
			},
			"id": "merge-generated",
			"name": "Wait For Generation",
			"type": "n8n-nodes-base.merge",
			"typeVersion": 3,
			"position": [750, 300]
		},
		{
			"parameters": {
				"jsCode": "// Get webhook input and generated content\nconst webhook = $('Webhook').first().json;\nconst linkedinRaw = $('Generate LinkedIn').first().json;\nconst twitterRaw = $('Generate Twitter').first().json;\nconst devtoRaw = $('Generate DevTo').first().json;\n\n// Parse content\nconst linkedinContent = linkedinRaw?.response || '';\nconst twitterContent = (twitterRaw?.response || '').trim();\nconst devtoContent = devtoRaw?.response || '';\n\n// Get scheduling info from webhook\nconst scheduleConfig = webhook.body?.schedule || {};\nconst linkedinDate = scheduleConfig.linkedin || new Date(Date.now() + 24*60*60*1000).toISOString();\nconst twitterDate = scheduleConfig.twitter || new Date(Date.now() + 48*60*60*1000).toISOString();\nconst devtoDate = scheduleConfig.devto || new Date(Date.now() + 24*60*60*1000).toISOString();\n\n// Prepare Postiz payloads\nconst linkedinPayload = {\n  type: 'schedule',\n  date: linkedinDate,\n  shortLink: false,\n  tags: [],\n  posts: [{\n    integration: { id: 'cmky9rja60001oc82ci8qle6v' },\n    value: [{ content: linkedinContent, image: [] }],\n    settings: { __type: 'linkedin' }\n  }]\n};\n\n// Twitter standalone tweet\nconst twitterPayload = {\n  type: 'schedule',\n  date: twitterDate,\n  shortLink: false,\n  tags: [],\n  posts: [{\n    integration: { id: 'cmkxmmwlk0001mj96243heh2y' },\n    value: [{ content: twitterContent, image: [] }],\n    settings: { __type: 'x', who_can_reply_post: 'everyone' }\n  }]\n};\n\n// Dev.to payload\nconst devtoPayload = {\n  type: 'schedule',\n  date: devtoDate,\n  shortLink: false,\n  tags: [],\n  posts: [{\n    integration: { id: 'cmky5o54e0001p397fhvbi0pp' },\n    value: [{ content: devtoContent, image: [] }],\n    settings: { \n      __type: 'devto', \n      title: webhook.body?.title || 'New Post'\n    }\n  }]\n};\n\nreturn [{\n  json: {\n    title: webhook.body?.title,\n    linkedinPayload,\n    twitterPayload,\n    devtoPayload,\n    generatedContent: {\n      linkedin: linkedinContent,\n      twitter: twitterContent,\n      devto: devtoContent\n    }\n  }\n}];"
			},
			"id": "prepare-postiz",
			"name": "Prepare Postiz Payloads",
			"type": "n8n-nodes-base.code",
			"typeVersion": 2,
			"position": [950, 300]
		},
		{
			"parameters": {
				"method": "POST",
				"url": "https://postiz.alexmayhew.dev/api/public/v1/posts",
				"sendHeaders": true,
				"headerParameters": {
					"parameters": [
						{
							"name": "Authorization",
							"value": "89fe6989c73476046100c9b0ffe2522b118ba8a8100b35ef07e919ecebceb6c3"
						},
						{
							"name": "Content-Type",
							"value": "application/json"
						}
					]
				},
				"sendBody": true,
				"specifyBody": "json",
				"jsonBody": "={{ JSON.stringify($json.linkedinPayload) }}",
				"options": {
					"timeout": 30000
				}
			},
			"id": "postiz-linkedin",
			"name": "Post to LinkedIn",
			"type": "n8n-nodes-base.httpRequest",
			"typeVersion": 4.2,
			"position": [1200, 100]
		},
		{
			"parameters": {
				"method": "POST",
				"url": "https://postiz.alexmayhew.dev/api/public/v1/posts",
				"sendHeaders": true,
				"headerParameters": {
					"parameters": [
						{
							"name": "Authorization",
							"value": "89fe6989c73476046100c9b0ffe2522b118ba8a8100b35ef07e919ecebceb6c3"
						},
						{
							"name": "Content-Type",
							"value": "application/json"
						}
					]
				},
				"sendBody": true,
				"specifyBody": "json",
				"jsonBody": "={{ JSON.stringify($json.twitterPayload) }}",
				"options": {
					"timeout": 30000
				}
			},
			"id": "postiz-twitter",
			"name": "Post to Twitter",
			"type": "n8n-nodes-base.httpRequest",
			"typeVersion": 4.2,
			"position": [1200, 300]
		},
		{
			"parameters": {
				"method": "POST",
				"url": "https://postiz.alexmayhew.dev/api/public/v1/posts",
				"sendHeaders": true,
				"headerParameters": {
					"parameters": [
						{
							"name": "Authorization",
							"value": "89fe6989c73476046100c9b0ffe2522b118ba8a8100b35ef07e919ecebceb6c3"
						},
						{
							"name": "Content-Type",
							"value": "application/json"
						}
					]
				},
				"sendBody": true,
				"specifyBody": "json",
				"jsonBody": "={{ JSON.stringify($json.devtoPayload) }}",
				"options": {
					"timeout": 30000
				}
			},
			"id": "postiz-devto",
			"name": "Post to DevTo",
			"type": "n8n-nodes-base.httpRequest",
			"typeVersion": 4.2,
			"position": [1200, 500]
		},
		{
			"parameters": {
				"mode": "append"
			},
			"id": "merge-posted",
			"name": "Wait For Posts",
			"type": "n8n-nodes-base.merge",
			"typeVersion": 3,
			"position": [1450, 300]
		},
		{
			"parameters": {
				"jsCode": "// Collect results\nconst prepared = $('Prepare Postiz Payloads').first().json;\nconst linkedinResult = $('Post to LinkedIn').first().json;\nconst twitterResult = $('Post to Twitter').first().json;\nconst devtoResult = $('Post to DevTo').first().json;\n\nreturn [{\n  json: {\n    success: true,\n    title: prepared.title,\n    generated_at: new Date().toISOString(),\n    scheduled: {\n      linkedin: {\n        success: !linkedinResult?.error,\n        response: linkedinResult\n      },\n      twitter: {\n        success: !twitterResult?.error,\n        response: twitterResult\n      },\n      devto: {\n        success: !devtoResult?.error,\n        response: devtoResult\n      }\n    },\n    content_preview: {\n      linkedin: prepared.generatedContent?.linkedin?.substring(0, 200) + '...',\n      twitter: prepared.generatedContent?.twitter || '',\n      devto: prepared.generatedContent?.devto?.substring(0, 200) + '...'\n    }\n  }\n}];"
			},
			"id": "format-response",
			"name": "Format Response",
			"type": "n8n-nodes-base.code",
			"typeVersion": 2,
			"position": [1650, 300]
		},
		{
			"parameters": {
				"respondWith": "json",
				"responseBody": "={{ $json }}",
				"options": {}
			},
			"id": "respond-webhook",
			"name": "Respond to Webhook",
			"type": "n8n-nodes-base.respondToWebhook",
			"typeVersion": 1.1,
			"position": [1850, 300]
		}
	],
	"connections": {
		"Webhook": {
			"main": [
				[
					{
						"node": "Generate LinkedIn",
						"type": "main",
						"index": 0
					},
					{
						"node": "Generate Twitter",
						"type": "main",
						"index": 0
					},
					{
						"node": "Generate DevTo",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Generate LinkedIn": {
			"main": [
				[
					{
						"node": "Wait For Generation",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Generate Twitter": {
			"main": [
				[
					{
						"node": "Wait For Generation",
						"type": "main",
						"index": 1
					}
				]
			]
		},
		"Generate DevTo": {
			"main": [
				[
					{
						"node": "Wait For Generation",
						"type": "main",
						"index": 2
					}
				]
			]
		},
		"Wait For Generation": {
			"main": [
				[
					{
						"node": "Prepare Postiz Payloads",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Prepare Postiz Payloads": {
			"main": [
				[
					{
						"node": "Post to LinkedIn",
						"type": "main",
						"index": 0
					},
					{
						"node": "Post to Twitter",
						"type": "main",
						"index": 0
					},
					{
						"node": "Post to DevTo",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Post to LinkedIn": {
			"main": [
				[
					{
						"node": "Wait For Posts",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Post to Twitter": {
			"main": [
				[
					{
						"node": "Wait For Posts",
						"type": "main",
						"index": 1
					}
				]
			]
		},
		"Post to DevTo": {
			"main": [
				[
					{
						"node": "Wait For Posts",
						"type": "main",
						"index": 2
					}
				]
			]
		},
		"Wait For Posts": {
			"main": [
				[
					{
						"node": "Format Response",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Format Response": {
			"main": [
				[
					{
						"node": "Respond to Webhook",
						"type": "main",
						"index": 0
					}
				]
			]
		}
	},
	"settings": {
		"executionOrder": "v1"
	}
}
